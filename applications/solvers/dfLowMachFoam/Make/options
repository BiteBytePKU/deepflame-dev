-include $(GENERAL_RULES)/mplibType
PYTHON_INC_DIR := $(shell python3 -m pybind11 --includes)
PYTHON_LIB_DIR := $(shell python3 -c "from distutils import sysconfig; \
    import os.path as op; v = sysconfig.get_config_vars(); \
    fpaths = [op.join(v[pv], v['LDLIBRARY']) for pv in ('LIBDIR', 'LIBPL')]; \
    print(list(filter(op.exists, fpaths))[0])" | xargs dirname)

EXE_INC = -std=c++14 \
    $(PFLAGS) $(PINC) \
    -I$(LIB_SRC)/transportModels/compressible/lnInclude \
    -I$(LIB_SRC)/thermophysicalModels/basic/lnInclude \
    -I$(LIB_SRC)/TurbulenceModels/turbulenceModels/lnInclude \
    -I$(LIB_SRC)/TurbulenceModels/compressible/lnInclude \
    -I$(LIB_SRC)/finiteVolume/cfdTools \
    -I$(LIB_SRC)/finiteVolume/lnInclude \
    -I$(LIB_SRC)/meshTools/lnInclude \
    -I$(LIB_SRC)/sampling/lnInclude \
    -I$(LIB_SRC)/dynamicFvMesh/lnInclude \
    -I$(LIB_SRC)/Pstream/mpi \
    -I$(DF_SRC)/CanteraMixture/lnInclude \
    -I$(DF_SRC)/dfChemistryModel/lnInclude \
    -I$(DF_SRC)/dfCombustionModels/lnInclude \
    -I$(CANTERA_ROOT)/include \
    $(if $(LIBTORCH_ROOT),-I$(LIBTORCH_ROOT)/include,) \
    $(if $(LIBTORCH_ROOT),-I$(LIBTORCH_ROOT)/include/torch/csrc/api/include,) \
    $(PYTHON_INC_DIR)

EXE_LIBS = \
    -lcompressibleTransportModels \
    -lturbulenceModels \
    -lfiniteVolume \
    -lmeshTools \
    -lsampling \
    -L$(FOAM_USER_LIBBIN) \
    -ldfFluidThermophysicalModels \
    -ldfCompressibleTurbulenceModels \
    -lCanteraMixture \
    -ldfChemistryModel \
    -ldfCombustionModels  \
    $(CANTERA_ROOT)/lib/libcantera.so \
    $(if $(LIBTORCH_ROOT),$(LIBTORCH_ROOT)/lib/libtorch.so,) \
    $(if $(LIBTORCH_ROOT),$(LIBTORCH_ROOT)/lib/libc10.so,) \
    $(if $(LIBTORCH_ROOT),-rdynamic,) \
    $(if $(LIBTORCH_ROOT),-lpthread,) \
    -L$(PYTHON_LIB_DIR) \
    -lpython3.8
